{% extends 'base.html' %}
{% load bootstrap %}
{% load static %}


{% block content %}
<style type="text/css">
  td {
    vertical-align:middle;
    text-align:center;
    cursor: pointer;
  }
  th {
    vertical-align:middle;
    text-align:center;
  }

  .patients {
	    padding: 15px;
  	}

  /* .add-patient {
    margin: 0 auto;
    width: 100px;
  } */
</style>

<a href="{% url 'home' %}" class="btn btn-dark" style="border-radius: 0;"><</a>

<br><br>


<div class="container-fluid d-grid gap-3 align-items-center" style="grid-template-columns: 2fr;">
  <div class="d-flex align-items-left">
    <form class="w-100 me-3" method="get">
      <div class="form-floating">
        <input class="form-control"  name="q" type="search" id="id_q" placeholder="recherche">
        <label for="id_q">Rechercher des patients</label>
        <!-- {% if n_patients == 0 %}
        <p>Aucun patients trouvés</p>
        {% elif n_patients == 1 %}
        <p>1 patient trouvé</p>
        {% else %}
        <p>{{n_patients}} patients trouvés</p>
        {% endif %} -->
      </div>
    </form>
    <div class=add-patient>
      <a href="{% url 'patient:preop' %}" class="btn">
        <img src="{% static 'images/add_patient.svg' %}" class="icon2" width="40px" />
      </a>
    </div>

  </div>
  <br>






  {% if n_patients %}

    <script src="https://www.kryogenix.org/code/browser/sorttable/sorttable.js"></script>

  <div class="table-responsive">
    <table id="mytable" class="table table-bordred table-striped sortable">
      <thead>
        <th>N°Utah</th>
        <th>Prénom</th>
        <th>Nom</th>
        <th>Intervention</th>
        <th>Chirurgie</th>
        <th>Pathologie</th>
        <th>Chirurgien</th>
        <th>Consultation</th>
      </thead>
      <tbody>
        {% for file in patients %}
          <tr data-href="{% url 'patient:detail' file.slug %}">
            <td>{{file.incl_num}}</td>
            <td>{{file.firstname}}</td>
            <td>{{file.lastname}}</td>
            <td>{{file.intervention}}</td>
            <td>{{file.chirurgie}}</td>
            <td>{{file.pathologie}}</td>
            <td>{{file.chirurgien}}</td>
            <td>{{file.consultant}}</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
   </div>
  {% include 'patient/snippets/patient_pagination.html' with patients=patients %}

  {% endif %}

</div>


<script type="text/javascript">
	document.getElementById("id_q").value = "{{query}}";
  $('tr[data-href]').on("click", function() {
      document.location = $(this).data('href');
  });
</script>

{% endblock content %}
